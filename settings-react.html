<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨­å®š (Reactç‰ˆ) - LLM Desktop Mascot</title>
    
    <!-- Phase 2.5ãƒ‡ã‚¶ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ç¶™æ‰¿ -->
    <link rel="stylesheet" href="src/styles/design-system.css">
    <link rel="stylesheet" href="src/styles/components.css">
    
    <!-- Reactç‰ˆå°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        /* React root container */
        #react-settings-root {
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        
        /* ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤º */
        .react-fallback {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #BFECFF 0%, #CDC1FF 100%);
            flex-direction: column;
            text-align: center;
            padding: 2rem;
        }
        
        .react-fallback h1 {
            color: #333;
            margin-bottom: 1rem;
            font-size: 2rem;
        }
        
        .react-fallback p {
            color: #666;
            font-size: 1.1rem;
            margin-bottom: 2rem;
        }
        
        .react-fallback .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #BFECFF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .react-fallback .error {
            background: #fee2e2;
            border: 2px solid #ef4444;
            border-radius: 8px;
            padding: 1rem;
            color: #991b1b;
            max-width: 500px;
            margin-top: 1rem;
        }
        
        /* Dev Toolsè¡¨ç¤º */
        .dev-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 0.5rem;
            border-radius: 4px;
            font-family: monospace;
            font-size: 0.8rem;
            z-index: 9999;
            display: none;
        }
        
        .dev-info.show {
            display: block;
        }
    </style>
</head>
<body>
    <!-- React ãƒã‚¦ãƒ³ãƒˆãƒã‚¤ãƒ³ãƒˆ -->
    <div id="react-settings-root">
        <!-- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤ºï¼ˆReactèª­ã¿è¾¼ã¿å‰ãƒ»ã‚¨ãƒ©ãƒ¼æ™‚ï¼‰ -->
        <div class="react-fallback" id="react-fallback">
            <h1>ğŸš€ Reactè¨­å®šç”»é¢</h1>
            <p>React ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
            <div class="spinner"></div>
            
            <!-- JavaScriptç„¡åŠ¹æ™‚ã®è¡¨ç¤º -->
            <noscript>
                <div class="error">
                    <h2>âŒ JavaScript ãŒç„¡åŠ¹ã§ã™</h2>
                    <p>ã“ã®è¨­å®šç”»é¢ã¯JavaScriptãŒå¿…è¦ã§ã™ã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã§JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚</p>
                    <p>ã¾ãŸã¯ã€å¾“æ¥ç‰ˆã®è¨­å®šç”»é¢ã‚’ã”åˆ©ç”¨ãã ã•ã„: <a href="settings.html">settings.html</a></p>
                </div>
            </noscript>
        </div>
    </div>
    
    <!-- é–‹ç™ºè€…æƒ…å ±è¡¨ç¤º -->
    <div class="dev-info" id="dev-info">
        <div>Mode: <span id="dev-mode">development</span></div>
        <div>React: <span id="react-status">loading</span></div>
        <div>ElectronAPI: <span id="api-status">checking</span></div>
    </div>
    
    <!-- React Entry Point -->
    <script type="module" src="/src/renderer/main.tsx"></script>
    
    <!-- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚° -->
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        window.addEventListener('error', (event) => {
            console.error('React Settings Error:', event.error);
            showReactError(event.error);
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('React Settings Unhandled Promise:', event.reason);
            showReactError(new Error(`Promise rejection: ${event.reason}`));
        });
        
        function showReactError(error) {
            const fallback = document.getElementById('react-fallback');
            if (fallback) {
                fallback.innerHTML = `
                    <h1>âŒ Reactèª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼</h1>
                    <p>Reactè¨­å®šç”»é¢ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</p>
                    <div class="error">
                        <h3>ã‚¨ãƒ©ãƒ¼è©³ç´°:</h3>
                        <pre>${error.message}</pre>
                        <p style="margin-top: 1rem;">
                            <strong>è§£æ±ºæ–¹æ³•:</strong><br>
                            1. ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„<br>
                            2. å•é¡ŒãŒç¶šãå ´åˆã¯ã€å¾“æ¥ç‰ˆã‚’ã”åˆ©ç”¨ãã ã•ã„: 
                            <a href="settings.html" style="color: #0066cc;">settings.html</a>
                        </p>
                    </div>
                `;
            }
        }
        
        // é–‹ç™ºè€…æƒ…å ±ã®æ›´æ–°
        function updateDevInfo() {
            const devInfo = document.getElementById('dev-info');
            const devMode = document.getElementById('dev-mode');
            const reactStatus = document.getElementById('react-status');
            const apiStatus = document.getElementById('api-status');
            
            if (devMode) devMode.textContent = process?.env?.NODE_ENV || 'unknown';
            
            // ElectronAPIçŠ¶æ…‹ç¢ºèª
            if (apiStatus) {
                if (window.electronAPI) {
                    apiStatus.textContent = 'available';
                    apiStatus.style.color = '#10b981';
                } else {
                    apiStatus.textContent = 'unavailable';
                    apiStatus.style.color = '#ef4444';
                }
            }
            
            // é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§ã®ã¿è¡¨ç¤º
            if (process?.env?.NODE_ENV === 'development') {
                devInfo?.classList.add('show');
            }
        }
        
        // Reactèª­ã¿è¾¼ã¿æˆåŠŸæ™‚ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯
        window.onReactReady = function() {
            const reactStatus = document.getElementById('react-status');
            const fallback = document.getElementById('react-fallback');
            
            if (reactStatus) {
                reactStatus.textContent = 'ready';
                reactStatus.style.color = '#10b981';
            }
            
            // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯è¡¨ç¤ºã‚’éš ã™
            if (fallback) {
                fallback.style.display = 'none';
            }
            
            console.log('âœ… React Settings App ready');
        };
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            updateDevInfo();
            
            // 5ç§’çµŒã£ã¦ã‚‚ReactãŒèª­ã¿è¾¼ã¾ã‚Œãªã„å ´åˆã¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
            setTimeout(() => {
                const fallback = document.getElementById('react-fallback');
                if (fallback && fallback.style.display !== 'none') {
                    showReactError(new Error('Reactèª­ã¿è¾¼ã¿ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆ5ç§’ï¼‰'));
                }
            }, 5000);
        });
    </script>
</body>
</html>